<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: FontInstaller
  
    &mdash; Documentation by YARD 0.9.27
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "FontInstaller";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (F)</a> &raquo;
    
    
    <span class="title">FontInstaller</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: FontInstaller
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>scripts/PScreen_Load.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Font installer</p>


  </div>
</div>
<div class="tags">
  

</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="Filenames-constant" class="">Filenames =
          <div class="docstring">
  <div class="discussion">
    
<p>filenames of fonts to be installed</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbracket'>[</span>
   <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pkmnem.ttf</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
   <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pkmnemn.ttf</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
   <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pkmnems.ttf</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
   <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pkmnrs.ttf</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
   <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pkmndp.ttf</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
   <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pkmnfl.ttf</span><span class='tstring_end'>&#39;</span></span>
<span class='rbracket'>]</span></pre></dd>
      
        <dt id="Names-constant" class="">Names =
          <div class="docstring">
  <div class="discussion">
    
<p>names (not filenames) of fonts to be installed</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbracket'>[</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Power Green</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Power Green Narrow</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Power Green Small</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Power Red and Blue</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Power Clear</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Power Red and Green</span><span class='tstring_end'>&#39;</span></span>
<span class='rbracket'>]</span></pre></dd>
      
        <dt id="Notify-constant" class="">Notify =
          <div class="docstring">
  <div class="discussion">
    
<p>whether to notify player (via pop-up message) that fonts were installed</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='kw'>true</span></pre></dd>
      
        <dt id="Source-constant" class="">Source =
          <div class="docstring">
  <div class="discussion">
    
<p>location of fonts (relative to game folder)</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Fonts/</span><span class='tstring_end'>&#39;</span></span></pre></dd>
      
        <dt id="AFR-constant" class="">AFR =
          
        </dt>
        <dd><pre class="code"><span class='const'><span class='object_link'><a href="Win32API.html" title="Win32API (class)">Win32API</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>gdi32</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AddFontResource</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>P</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>L</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></pre></dd>
      
        <dt id="WPS-constant" class="">WPS =
          
        </dt>
        <dd><pre class="code"><span class='const'><span class='object_link'><a href="Win32API.html" title="Win32API (class)">Win32API</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>kernel32</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>WriteProfileString</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>P</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>*</span> <span class='int'>3</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>L</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></pre></dd>
      
        <dt id="SM-constant" class="">SM =
          
        </dt>
        <dd><pre class="code"><span class='const'><span class='object_link'><a href="Win32API.html" title="Win32API (class)">Win32API</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user32</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PostMessage</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>L</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>*</span> <span class='int'>4</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>L</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></pre></dd>
      
        <dt id="WM_FONTCHANGE-constant" class="">WM_FONTCHANGE =
          
        </dt>
        <dd><pre class="code"><span class='int'>0x001D</span></pre></dd>
      
        <dt id="HWND_BROADCAST-constant" class="">HWND_BROADCAST =
          
        </dt>
        <dd><pre class="code"><span class='int'>0xffff</span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#copy_file-class_method" title="copy_file (class method)">.<strong>copy_file</strong>(src, dest)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#getFontFolder-class_method" title="getFontFolder (class method)">.<strong>getFontFolder</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#install-class_method" title="install (class method)">.<strong>install</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#pbResolveFont-class_method" title="pbResolveFont (class method)">.<strong>pbResolveFont</strong>(name)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="copy_file-class_method">
  
    .<strong>copy_file</strong>(src, dest)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


517
518
519
520
521
522
523
524
525</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'scripts/PScreen_Load.rb', line 517</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_copy_file'>copy_file</span><span class='lparen'>(</span><span class='id identifier rubyid_src'>src</span><span class='comma'>,</span><span class='id identifier rubyid_dest'>dest</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="File.html" title="File (class)">File</a></span></span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_src'>src</span><span class='comma'>,</span>  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rb</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_r'>r</span><span class='op'>|</span>
     <span class='const'><span class='object_link'><a href="File.html" title="File (class)">File</a></span></span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_dest'>dest</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wb</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_w'>w</span><span class='op'>|</span>
        <span class='kw'>while</span> <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='int'>4096</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_w'>w</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_s'>s</span>
        <span class='kw'>end</span>
     <span class='rbrace'>}</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="getFontFolder-class_method">
  
    .<strong>getFontFolder</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


497
498
499
500
501
502
503
504
505
506
507
508
509</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'scripts/PScreen_Load.rb', line 497</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_getFontFolder'>getFontFolder</span>
  <span class='id identifier rubyid_fontfolder'>fontfolder</span><span class='op'>=</span><span class='const'>MiniRegistry</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="MiniRegistry.html" title="MiniRegistry (module)">MiniRegistry</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="MiniRegistry.html#HKEY_CURRENT_USER-constant" title="MiniRegistry::HKEY_CURRENT_USER (constant)">HKEY_CURRENT_USER</a></span></span><span class='comma'>,</span>
     <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
     <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Fonts</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_fontfolder'>fontfolder</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_fontfolder'>fontfolder</span>
  <span class='kw'>if</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SystemRoot</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='kw'>return</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SystemRoot</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>\\Fonts\\</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>elsif</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>windir</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='kw'>return</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>windir</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>\\Fonts\\</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>\\Windows\\Fonts\\</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>   
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="install-class_method">
  
    .<strong>install</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'scripts/PScreen_Load.rb', line 534</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_install'>install</span>
  <span class='id identifier rubyid_success'>success</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='comment'># Check if all fonts already exist
</span>  <span class='id identifier rubyid_filesExist'>filesExist</span><span class='op'>=</span><span class='kw'>true</span>
  <span class='id identifier rubyid_fontsExist'>fontsExist</span><span class='op'>=</span><span class='kw'>true</span>
  <span class='id identifier rubyid_dest'>dest</span><span class='op'>=</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_getFontFolder'>getFontFolder</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>0</span><span class='op'>...</span><span class='const'><span class='object_link'><a href="#Names-constant" title="FontInstaller::Names (constant)">Names</a></span></span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_safeExists?'><span class='object_link'><a href="top-level-namespace.html#safeExists%3F-instance_method" title="#safeExists? (method)">safeExists?</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_dest'>dest</span> <span class='op'>+</span> <span class='const'><span class='object_link'><a href="#Filenames-constant" title="FontInstaller::Filenames (constant)">Filenames</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_filesExist'>filesExist</span><span class='op'>=</span><span class='kw'>false</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='const'>Font</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#Names-constant" title="FontInstaller::Names (constant)">Names</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_fontsExist'>fontsExist</span><span class='op'>=</span><span class='kw'>false</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_filesExist'>filesExist</span>
  <span class='comment'># Check if all source fonts exist
</span>  <span class='id identifier rubyid_exist'>exist</span><span class='op'>=</span><span class='kw'>true</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>0</span><span class='op'>...</span><span class='const'><span class='object_link'><a href="#Names-constant" title="FontInstaller::Names (constant)">Names</a></span></span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='const'><span class='object_link'><a href="RTP.html" title="RTP (module)">RTP</a></span></span><span class='period'>.</span><span class='id identifier rubyid_exists?'><span class='object_link'><a href="RTP.html#exists%3F-class_method" title="RTP.exists? (method)">exists?</a></span></span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#Source-constant" title="FontInstaller::Source (constant)">Source</a></span></span> <span class='op'>+</span> <span class='const'><span class='object_link'><a href="#Filenames-constant" title="FontInstaller::Filenames (constant)">Filenames</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_exist'>exist</span><span class='op'>=</span><span class='kw'>false</span>
      <span class='kw'>break</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_exist'>exist</span> <span class='comment'># Exit if not all source fonts exist
</span>  <span class='const'><span class='object_link'><a href="Kernel.html" title="Kernel (module)">Kernel</a></span></span><span class='period'>.</span><span class='id identifier rubyid_pbMessage'><span class='object_link'><a href="Kernel.html#pbMessage-class_method" title="Kernel.pbMessage (method)">pbMessage</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid__INTL'><span class='object_link'><a href="top-level-namespace.html#_INTL-instance_method" title="#_INTL (method)">_INTL</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Una o más fuentes usadas en este juego no existen en el sistema.\1</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="Kernel.html" title="Kernel (module)">Kernel</a></span></span><span class='period'>.</span><span class='id identifier rubyid_pbMessage'><span class='object_link'><a href="Kernel.html#pbMessage-class_method" title="Kernel.pbMessage (method)">pbMessage</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid__INTL'><span class='object_link'><a href="top-level-namespace.html#_INTL-instance_method" title="#_INTL (method)">_INTL</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>El juego puede continuar, pero la presentación del texto del juego no será la óptima.\1</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_failed'>failed</span><span class='op'>=</span><span class='kw'>false</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>0</span><span class='op'>...</span><span class='const'><span class='object_link'><a href="#Filenames-constant" title="FontInstaller::Filenames (constant)">Filenames</a></span></span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
    <span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="#Filenames-constant" title="FontInstaller::Filenames (constant)">Filenames</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_safeExists?'><span class='object_link'><a href="top-level-namespace.html#safeExists%3F-instance_method" title="#safeExists? (method)">safeExists?</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_dest'>dest</span> <span class='op'>+</span> <span class='id identifier rubyid_f'>f</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='const'>Font</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#Names-constant" title="FontInstaller::Names (constant)">Names</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='const'><span class='object_link'><a href="File.html" title="File (class)">File</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_dest'>dest</span> <span class='op'>+</span> <span class='id identifier rubyid_f'>f</span><span class='rparen'>)</span> <span class='kw'>rescue</span> <span class='kw'>nil</span>
    <span class='kw'>end</span>
    <span class='comment'># check if already installed...
</span>    <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_safeExists?'><span class='object_link'><a href="top-level-namespace.html#safeExists%3F-instance_method" title="#safeExists? (method)">safeExists?</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_dest'>dest</span> <span class='op'>+</span> <span class='id identifier rubyid_f'>f</span><span class='rparen'>)</span>
      <span class='comment'># check to ensure font is in specified location...
</span>      <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="RTP.html" title="RTP (module)">RTP</a></span></span><span class='period'>.</span><span class='id identifier rubyid_exists?'><span class='object_link'><a href="RTP.html#exists%3F-class_method" title="RTP.exists? (method)">exists?</a></span></span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#Source-constant" title="FontInstaller::Source (constant)">Source</a></span></span> <span class='op'>+</span> <span class='id identifier rubyid_f'>f</span><span class='rparen'>)</span>
        <span class='comment'># copy file to fonts folder
</span>        <span class='id identifier rubyid_succeeded'>succeeded</span><span class='op'>=</span><span class='kw'>false</span>
        <span class='kw'>begin</span>
          <span class='id identifier rubyid_copy_file'>copy_file</span><span class='lparen'>(</span><span class='id identifier rubyid_pbResolveFont'>pbResolveFont</span><span class='lparen'>(</span><span class='id identifier rubyid_f'>f</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_dest'>dest</span> <span class='op'>+</span> <span class='id identifier rubyid_f'>f</span><span class='rparen'>)</span>
          <span class='comment'># add font resource
</span>          <span class='const'><span class='object_link'><a href="#AFR-constant" title="FontInstaller::AFR (constant)">AFR</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_dest'>dest</span> <span class='op'>+</span> <span class='id identifier rubyid_f'>f</span><span class='rparen'>)</span>
          <span class='comment'># add entry to win.ini/registry
</span>          <span class='const'><span class='object_link'><a href="#WPS-constant" title="FontInstaller::WPS (constant)">WPS</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Fonts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="#Names-constant" title="FontInstaller::Names (constant)">Names</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> (TrueType)</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_f'>f</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_succeeded'>succeeded</span><span class='op'>=</span><span class='id identifier rubyid_safeExists?'>safeExists?</span><span class='lparen'>(</span><span class='id identifier rubyid_dest'>dest</span> <span class='op'>+</span> <span class='id identifier rubyid_f'>f</span><span class='rparen'>)</span>
        <span class='kw'>rescue</span> <span class='const'>SystemCallError</span>
          <span class='comment'># failed
</span>          <span class='id identifier rubyid_succeeded'>succeeded</span><span class='op'>=</span><span class='kw'>false</span>
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_succeeded'>succeeded</span>
          <span class='id identifier rubyid_success'>success</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#Names-constant" title="FontInstaller::Names (constant)">Names</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='rparen'>)</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_failed'>failed</span><span class='op'>=</span><span class='kw'>true</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_success'>success</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#Names-constant" title="FontInstaller::Names (constant)">Names</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='comment'># assume success
</span>    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_success'>success</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>&gt;</span><span class='int'>0</span> <span class='comment'># one or more fonts successfully installed
</span>    <span class='const'><span class='object_link'><a href="#SM-constant" title="FontInstaller::SM (constant)">SM</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#HWND_BROADCAST-constant" title="FontInstaller::HWND_BROADCAST (constant)">HWND_BROADCAST</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="#WM_FONTCHANGE-constant" title="FontInstaller::WM_FONTCHANGE (constant)">WM_FONTCHANGE</a></span></span><span class='comma'>,</span><span class='int'>0</span><span class='comma'>,</span><span class='int'>0</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="#Notify-constant" title="FontInstaller::Notify (constant)">Notify</a></span></span>
      <span class='id identifier rubyid_fonts'>fonts</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_success'>success</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
        <span class='id identifier rubyid_fonts'>fonts</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_f'>f</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>end</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_failed'>failed</span>
        <span class='const'><span class='object_link'><a href="Kernel.html" title="Kernel (module)">Kernel</a></span></span><span class='period'>.</span><span class='id identifier rubyid_pbMessage'><span class='object_link'><a href="Kernel.html#pbMessage-class_method" title="Kernel.pbMessage (method)">pbMessage</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid__INTL'><span class='object_link'><a href="top-level-namespace.html#_INTL-instance_method" title="#_INTL (method)">_INTL</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Se instalaron exitosamente algunas de las fuentes.\1</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='const'><span class='object_link'><a href="Kernel.html" title="Kernel (module)">Kernel</a></span></span><span class='period'>.</span><span class='id identifier rubyid_pbMessage'><span class='object_link'><a href="Kernel.html#pbMessage-class_method" title="Kernel.pbMessage (method)">pbMessage</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid__INTL'><span class='object_link'><a href="top-level-namespace.html#_INTL-instance_method" title="#_INTL (method)">_INTL</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Para instalar las otras fuentes, copie los archivos de la carpeta Fonts del juego a la carpeta Fonts del Panel de Control.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='const'><span class='object_link'><a href="Kernel.html" title="Kernel (module)">Kernel</a></span></span><span class='period'>.</span><span class='id identifier rubyid_pbMessage'><span class='object_link'><a href="Kernel.html#pbMessage-class_method" title="Kernel.pbMessage (method)">pbMessage</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid__INTL'><span class='object_link'><a href="top-level-namespace.html#_INTL-instance_method" title="#_INTL (method)">_INTL</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Las fuentes se instalaron exitosamente.\1</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="Kernel.html" title="Kernel (module)">Kernel</a></span></span><span class='period'>.</span><span class='id identifier rubyid_pbConfirmMessage'><span class='object_link'><a href="Kernel.html#pbConfirmMessage-class_method" title="Kernel.pbConfirmMessage (method)">pbConfirmMessage</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid__INTL'><span class='object_link'><a href="top-level-namespace.html#_INTL-instance_method" title="#_INTL (method)">_INTL</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>¿Quieres reiniciar el juego para aplicar los cambios?</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Thread.html" title="Thread (class)">Thread</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_system'>system</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Game</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='rbrace'>}</span>
        <span class='id identifier rubyid_exit'><span class='object_link'><a href="top-level-namespace.html#exit-instance_method" title="#exit (method)">exit</a></span></span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='comment'># No fonts were installed.
</span>    <span class='const'><span class='object_link'><a href="Kernel.html" title="Kernel (module)">Kernel</a></span></span><span class='period'>.</span><span class='id identifier rubyid_pbMessage'><span class='object_link'><a href="Kernel.html#pbMessage-class_method" title="Kernel.pbMessage (method)">pbMessage</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid__INTL'><span class='object_link'><a href="top-level-namespace.html#_INTL-instance_method" title="#_INTL (method)">_INTL</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Para instalar las fuentes apropiadas, copie los archivos de la carpeta Fonts del juego a la carpeta Fonts del Panel de Control.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="pbResolveFont-class_method">
  
    .<strong>pbResolveFont</strong>(name)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


527
528
529
530
531
532</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'scripts/PScreen_Load.rb', line 527</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_pbResolveFont'>pbResolveFont</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="RTP.html" title="RTP (module)">RTP</a></span></span><span class='period'>.</span><span class='id identifier rubyid_eachPathFor'><span class='object_link'><a href="RTP.html#eachPathFor-class_method" title="RTP.eachPathFor (method)">eachPathFor</a></span></span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#Source-constant" title="FontInstaller::Source (constant)">Source</a></span></span><span class='op'>+</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
     <span class='kw'>return</span> <span class='id identifier rubyid_file'>file</span> <span class='kw'>if</span> <span class='id identifier rubyid_safeExists?'><span class='object_link'><a href="top-level-namespace.html#safeExists%3F-instance_method" title="#safeExists? (method)">safeExists?</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
  <span class='rbrace'>}</span>
  <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="#Source-constant" title="FontInstaller::Source (constant)">Source</a></span></span><span class='op'>+</span><span class='id identifier rubyid_name'>name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu May 19 20:12:21 2022 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.27 (ruby-2.7.5).
</div>

    </div>
  </body>
</html>